{
  "variables": [],
  "info": {
    "name": "Requests API (used by Jenkins) - Admin - Public",
    "_postman_id": "1867b2c0-fcdf-9eef-0e5d-d219930e121c",
    "description": "This collection contains requests used by Jenkins to test our API",
    "schema": "https://schema.getpostman.com/json/collection/v2.0.0/collection.json"
  },
  "item": [
    {
      "_postman_id": "8cebfdd8-f5f5-998c-680d-fc9f4eddbdfb",
      "name": "https://gst.atreal.fr/api/v1/ping",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 200\"] = responseCode.code === 200;",
              "tests[\"Response is OK\"] = responseBody === 'OK';"
            ]
          }
        }
      ],
      "request": {
        "url": "https://gst.atreal.fr/api/v1/ping",
        "method": "GET",
        "header": [
          {
            "key": "Accept",
            "value": "*/*",
            "description": ""
          },
          {
            "key": "X-Requested-With",
            "value": "XMLHttpRequest",
            "description": ""
          },
          {
            "key": "User-Agent",
            "value": "Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2840.99 Safari/537.36",
            "description": ""
          },
          {
            "key": "Authorization",
            "value": "Token token=7695535153c9e8acb19c1830ce8736fa",
            "description": ""
          },
          {
            "key": "Accept-Encoding",
            "value": "gzip, deflate, sdch, br",
            "description": ""
          },
          {
            "key": "Accept-Language",
            "value": "fr-FR,fr;q=0.8,en-US;q=0.6,en;q=0.4",
            "description": ""
          },
          {
            "key": "Cookie",
            "value": "session0|session_id=%22%22; connect.sid=s%3A9e984315-4d55-496c-a7cf-06bfe711df3a.OD85HPOJ8clIOZxagfEX%2Fps7Pi%2BuSliu%2FU0SAFI1wmw; sessionid=52314e2d3754f719c3710fe8750a7c6d8b8acbd9",
            "description": ""
          }
        ],
        "body": {},
        "description": "test if resaframe in prod is up"
      },
      "response": []
    },
    {
      "_postman_id": "390c11f2-c664-bb0f-f4a5-67d5c8770392",
      "name": "http://gmao.ville-lannion.fr/api/v1/lannion/open_object/partners?",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Lannion resaframe ASSO select seems fine\"] = responseCode.code === 200;"
            ]
          }
        }
      ],
      "request": {
        "url": "http://gmao.ville-lannion.fr/api/v1/lannion/open_object/partners?fields%5B%5D=id&fields%5B%5D=name&filters%5B0%5D%5Bfield%5D=name&filters%5B0%5D%5Boperator%5D=ilike&filters%5B0%5D%5Bvalue%5D=&filters%5B1%5D%5Bfield%5D=type_id.code&filters%5B1%5D%5Boperator%5D=ilike&filters%5B1%5D%5Bvalue%5D=ASSO",
        "method": "GET",
        "header": [
          {
            "key": "Accept",
            "value": "*/*",
            "description": ""
          },
          {
            "key": "X-Requested-With",
            "value": "XMLHttpRequest",
            "description": ""
          },
          {
            "key": "User-Agent",
            "value": "Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2840.99 Safari/537.36",
            "description": ""
          },
          {
            "key": "Authorization",
            "value": "Token token=7695535153c9e8acb19c1830ce8736fa",
            "description": ""
          },
          {
            "key": "Referer",
            "value": "https://gst.atreal.fr/saint-barthelemy-anjou/resaframe/index.html",
            "description": ""
          },
          {
            "key": "Accept-Encoding",
            "value": "gzip, deflate, sdch, br",
            "description": ""
          },
          {
            "key": "Accept-Language",
            "value": "fr-FR,fr;q=0.8,en-US;q=0.6,en;q=0.4",
            "description": ""
          },
          {
            "key": "Cookie",
            "value": "session0|session_id=%22%22; connect.sid=s%3A9e984315-4d55-496c-a7cf-06bfe711df3a.OD85HPOJ8clIOZxagfEX%2Fps7Pi%2BuSliu%2FU0SAFI1wmw; sessionid=52314e2d3754f719c3710fe8750a7c6d8b8acbd9",
            "description": ""
          }
        ],
        "body": {},
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "49286977-a970-4e74-1a25-41ba9d772704",
      "name": "https://gst.atreal.fr/api/v1/lamontagne/open_object/partners?",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"La Montagne resaframe ASSO select seems fine\"] = responseCode.code === 200;"
            ]
          }
        }
      ],
      "request": {
        "url": "https://gst.atreal.fr/api/v1/lamontagne/open_object/partners?fields%5B%5D=id&fields%5B%5D=name&filters%5B0%5D%5Bfield%5D=name&filters%5B0%5D%5Boperator%5D=ilike&filters%5B0%5D%5Bvalue%5D=&filters%5B1%5D%5Bfield%5D=type_id.name&filters%5B1%5D%5Boperator%5D=ilike&filters%5B1%5D%5Bvalue%5D=asso",
        "method": "GET",
        "header": [
          {
            "key": "Accept",
            "value": "*/*",
            "description": ""
          },
          {
            "key": "X-Requested-With",
            "value": "XMLHttpRequest",
            "description": ""
          },
          {
            "key": "User-Agent",
            "value": "Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2840.99 Safari/537.36",
            "description": ""
          },
          {
            "key": "Authorization",
            "value": "Token token=7695535153c9e8acb19c1830ce8736fa",
            "description": ""
          },
          {
            "key": "Referer",
            "value": "https://gst.atreal.fr/saint-barthelemy-anjou/resaframe/index.html",
            "description": ""
          },
          {
            "key": "Accept-Encoding",
            "value": "gzip, deflate, sdch, br",
            "description": ""
          },
          {
            "key": "Accept-Language",
            "value": "fr-FR,fr;q=0.8,en-US;q=0.6,en;q=0.4",
            "description": ""
          },
          {
            "key": "Cookie",
            "value": "session0|session_id=%22%22; connect.sid=s%3A9e984315-4d55-496c-a7cf-06bfe711df3a.OD85HPOJ8clIOZxagfEX%2Fps7Pi%2BuSliu%2FU0SAFI1wmw; sessionid=52314e2d3754f719c3710fe8750a7c6d8b8acbd9",
            "description": ""
          }
        ],
        "body": {},
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "3056b712-125e-16f5-f80a-15a84013818c",
      "name": "authenticate",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "var jsonData = JSON.parse(responseBody);",
              "postman.setEnvironmentVariable(\"sessionId\", jsonData.result.session_id);",
              "postman.setEnvironmentVariable(\"uid\", jsonData.result.uid);",
              "tests[\"Authenticate Bdd\"] = jsonData.result.db === 'test_api';",
              "tests[\"Authenticate as admin\"] = jsonData.result.uid === 1;"
            ]
          }
        }
      ],
      "request": {
        "url": "{{server}}/web/session/authenticate",
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json;charset=UTF-8",
            "description": ""
          },
          {
            "key": "Accept",
            "value": "application/json",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\r\n  \"id\": \"r1\",\r\n  \"jsonrpc\": \"2.0\",\r\n  \"method\": \"call\",\r\n  \"params\": {\r\n    \"login\": \"{{login}}\",\r\n    \"password\": \"{{password}}\",\r\n    \"db\": \"{{db}}\"\r\n  }\r\n}"
        },
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "e24b0325-ec42-c177-cb40-315af5b3bbd1",
      "name": "get 'res.users'",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "var jsonData = JSON.parse(responseBody);",
              "tests[\"get Users Bdd\"] = jsonData.result[0].user_id[1]==='Administrator';"
            ]
          }
        }
      ],
      "request": {
        "url": "{{server}}/web/dataset/get",
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json;charset=UTF-8",
            "description": ""
          },
          {
            "key": "Accept",
            "value": "application/json",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\r\n  \"id\": \"r2\",\r\n  \"jsonrpc\": \"2.0\",\r\n  \"method\": \"call\",\r\n  \"params\": {\r\n    \"model\": \"res.users\",\r\n    \"ids\": [{{uid}}],\r\n    \"session_id\": \"{{sessionId}}\"\r\n  }\r\n}"
        },
        "description": "pour connaitre des infos à renseigner dans la demande"
      },
      "response": []
    },
    {
      "_postman_id": "e188fe84-cbd5-7c23-b759-5db635b84bab",
      "name": "get Organisations 'Particuliers Commune' id copy",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "var jsonData = JSON.parse(responseBody);",
              "postman.setEnvironmentVariable(\"resPartner.id\", jsonData.result.ids[0]);",
              "tests[\"Find one 'Particuliers Commune'\"] = jsonData.result.length === 1;"
            ]
          }
        }
      ],
      "request": {
        "url": "{{server}}/web/dataset/search_read",
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json;charset=UTF-8",
            "description": ""
          },
          {
            "key": "Accept",
            "value": "application/json",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\r\n  \"id\": \"r2\",\r\n  \"jsonrpc\": \"2.0\",\r\n  \"method\": \"call\",\r\n  \"params\": {\r\n    \"sort\": \"name ASC\",\r\n    \"limit\": 20,\r\n    \"offset\": 0,\r\n    \"model\": \"res.partner\",\r\n    \"fields\": [\r\n      \"id\"\r\n    ],\r\n    \"domain\": [\r\n      [\r\n        \"name\",\r\n        \"ilike\",\r\n        \"Particuliers Commune\"\r\n      ],\r\n      [\r\n        \"subname\",\r\n        \"ilike\",\r\n        \"Particuliers Commune\"\r\n      ]\r\n    ],\r\n    \"session_id\": \"{{sessionId}}\",\r\n    \"context\": {\r\n      \"__ref\": \"compound_context\",\r\n      \"__contexts\": [\r\n        {\r\n          \"lang\": \"fr_FR\",\r\n          \"tz\": \"Europe/Paris\",\r\n          \"uid\": {{uid}}\r\n        },\r\n        {\r\n          \"bin_size\": true\r\n        }\r\n      ],\r\n      \"__eval_context\": null\r\n    }\r\n  }\r\n}"
        },
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "beb117e5-c792-1df7-5b96-845d04d65fca",
      "name": "get Roles 'Demandeur externe' id copy",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "var jsonData = JSON.parse(responseBody);",
              "postman.setEnvironmentVariable(\"resGroups.DemandeurExterne.id\", jsonData.result.ids[0]);",
              "tests[\"Find one 'Demandeur externe'\"] = jsonData.result.length === 1;"
            ]
          }
        }
      ],
      "request": {
        "url": "{{server}}/web/dataset/search_read",
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json;charset=UTF-8",
            "description": ""
          },
          {
            "key": "Accept",
            "value": "application/json",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\r\n  \"id\": \"r3\",\r\n  \"jsonrpc\": \"2.0\",\r\n  \"method\": \"call\",\r\n  \"params\": {\r\n    \"sort\": \"name ASC\",\r\n    \"limit\": 0,\r\n    \"offset\": 0,\r\n    \"fields\": [\r\n      \"id\"\r\n    ],\r\n    \"model\": \"res.groups\",\r\n    \"domain\": [\r\n      [\r\n        \"name\",\r\n        \"ilike\",\r\n        \"Demandeur externe\"\r\n      ],\r\n      [\r\n        \"full_name\",\r\n        \"ilike\",\r\n        \"Demandeur externe\"\r\n      ]\r\n    ],\r\n    \"session_id\": \"{{sessionId}}\",\r\n    \"context\": {\r\n      \"__ref\": \"compound_context\",\r\n      \"__contexts\": [\r\n        {\r\n          \"lang\": \"fr_FR\",\r\n          \"tz\": \"Europe/Paris\",\r\n          \"uid\": {{uid}}\r\n        },\r\n        {\r\n          \"bin_size\": true\r\n        }\r\n      ],\r\n      \"__eval_context\": null\r\n    }\r\n  }\r\n}"
        },
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "2bfc828b-9b7b-25b5-28ff-7e4364e8fbe6",
      "name": "get Roles 'Demandeur' id copy",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "var jsonData = JSON.parse(responseBody);",
              "postman.setEnvironmentVariable(\"resGroups.Demandeur.id\", jsonData.result.ids[0]);",
              "tests[\"Find one 'Demandeur'\"] = jsonData.result.length === 1;"
            ]
          }
        }
      ],
      "request": {
        "url": "{{server}}/web/dataset/search_read",
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json;charset=UTF-8",
            "description": ""
          },
          {
            "key": "Accept",
            "value": "application/json",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\r\n  \"id\": \"r3\",\r\n  \"jsonrpc\": \"2.0\",\r\n  \"method\": \"call\",\r\n  \"params\": {\r\n    \"sort\": \"name ASC\",\r\n    \"limit\": 0,\r\n    \"offset\": 0,\r\n    \"fields\": [\r\n      \"id\",\r\n      \"name\",\r\n      \"implied_ids\",\r\n      \"trans_implied_ids\",\r\n      \"category_id\",\r\n      \"code\"\r\n    ],\r\n    \"model\": \"res.groups\",\r\n    \"domain\": [\r\n      [\r\n        \"name\",\r\n        \"ilike\",\r\n        \"Demandeur\"\r\n      ],\r\n      [\r\n        \"full_name\",\r\n        \"ilike\",\r\n        \"Demandeur\"\r\n      ],\r\n            [\r\n        \"code\",\r\n        \"ilike\",\r\n        \"PART\"\r\n      ]\r\n    ],\r\n    \"session_id\": \"{{sessionId}}\",\r\n    \"context\": {\r\n      \"__ref\": \"compound_context\",\r\n      \"__contexts\": [\r\n        {\r\n          \"lang\": \"fr_FR\",\r\n          \"tz\": \"Europe/Paris\",\r\n          \"uid\": {{uid}}\r\n        },\r\n        {\r\n          \"bin_size\": true\r\n        }\r\n      ],\r\n      \"__eval_context\": null\r\n    }\r\n  }\r\n}"
        },
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "d7b73116-3247-1fa5-e584-10b50bc02f2f",
      "name": "search_read users",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "var jsonData = JSON.parse(responseBody);",
              "postman.setEnvironmentVariable(\"user.number\", jsonData.result.length);",
              "tests[\"Find users\"] = jsonData.result.ids.length != 1;"
            ]
          }
        }
      ],
      "request": {
        "url": "{{server}}/web/dataset/search_read",
        "method": "POST",
        "header": [
          {
            "key": "Accept",
            "value": "application/json, text/plain, */*",
            "description": ""
          },
          {
            "key": "Content-Type",
            "value": "application/json",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n\t\"jsonrpc\": \"2.0\",\n\t\"method\": \"call\",\n\t\"params\": {\n\t\t\"sort\": \"name ASC\",\n\t\t\"limit\": 20,\n\t\t\"offset\": 0,\n\t\t\"model\": \"res.users\",\n\t\t\"fields\": [\n\t\t\t\"achat_group\",\n\t\t\t\"actions\",\n\t\t\t\"active\",\n\t\t\t\"access_rights\",\n\t\t\t\"address_id\",\n\t\t\t\"city\",\n\t\t\t\"company_id\",\n\t\t\t\"complete_name\",\n\t\t\t\"contact_id\",\n\t\t\t\"context_lang\",\n\t\t\t\"context_tz\",\n\t\t\t\"cost\",\n\t\t\t\"current_group\",\n\t\t\t\"date\",\n\t\t\t\"email\",\n\t\t\t\"fluid_group\",\n\t\t\t\"function\",\n\t\t\t\"groups_id\",\n\t\t\t\"hex_color\",\n\t\t\t\"id\",\n\t\t\t\"is_assignable_to_task\",\n\t\t\t\"is_bookable_manager\",\n\t\t\t\"isDST\",\n\t\t\t\"isManager\",\n\t\t\t\"isResaManager\",\n\t\t\t\"lastname\",\n\t\t\t\"login\",\n\t\t\t\"managed_bookable_site_ids\",\n\t\t\t\"managed_bookable_equipment_ids\",\n\t\t\t\"managed_bookable_service_ids\",\n\t\t\t\"managed_bookables\",\n\t\t\t\"mobile\",\n\t\t\t\"name\",\n\t\t\t\"oauth_uid\",\n\t\t\t\"openresa_group\",\n\t\t\t\"patrimoine_group\",\n\t\t\t\"parcauto_group\",\n\t\t\t\"partner_id\",\n\t\t\t\"phone\",\n\t\t\t\"service_id\",\n\t\t\t\"service_ids\",\n\t\t\t\"service_names\",\n\t\t\t\"signature\",\n\t\t\t\"street\",\n\t\t\t\"tasks\",\n\t\t\t\"team_ids\",\n\t\t\t\"zip\",\n\t\t\t\"warehouse_ids\",\n\t\t\t\"openstc_employee_ref\"\n\t\t],\n\t\t\"session_id\": \"{{sessionId}}\",\n\t\t\"context\": {\n\t\t\t\"__ref\": \"compound_context\",\n\t\t\t\"__contexts\": [\n\t\t\t\t{\n\t\t\t\t\t\"lang\": \"fr_FR\",\n\t\t\t\t\t\"tz\": \"Europe/Paris\",\n\t\t\t\t\t\"uid\": {{uid}}\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"bin_size\": true\n\t\t\t\t}\n\t\t\t],\n\t\t\t\"__eval_context\": null\n\t\t}\n\t}\n}"
        },
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "9ea358ea-73c2-7bec-fb7c-25411ca51636",
      "name": "create user : Particuliers Commune - Demandeur externe copy",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"User creation seems fine\"] = responseCode.code === 200;",
              "var jsonData = JSON.parse(responseBody);",
              "tests[\"User created\"] = jsonData.result.result != 1;"
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "postman.setEnvironmentVariable('userLogin','login'+postman.getEnvironmentVariable('user.number'));",
              "postman.setEnvironmentVariable('userName','name'+postman.getEnvironmentVariable('user.number'));"
            ]
          }
        }
      ],
      "request": {
        "url": "{{server}}/web/dataset/create",
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json;charset=UTF-8",
            "description": ""
          },
          {
            "key": "Accept",
            "value": "application/json",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\r\n  \"id\": \"r7\",\r\n  \"jsonrpc\": \"2.0\",\r\n  \"method\": \"call\",\r\n  \"params\": {\r\n    \"data\": {\r\n      \"context_tz\": \"Europe/Paris\",\r\n      \"hex_color\": \"#2B0652\",\r\n      \"service_id\": false,\r\n      \"service_ids\": [[6,  0,[]]],\r\n      \"is_assignable_to_task\": false,\r\n      \"is_bookable_manager\": false,\r\n      \"image\": false,\r\n      \"login\": \"{{userLogin}}\",\r\n      \"new_password\": \"user1Mdp\",\r\n      \"name\": \"{{userName}}\",\r\n      \"function\": \"userFonction\",\r\n      \"email\": \"user@domain.com\",\r\n      \"phone\": \"0240033021\",\r\n      \"mobile\": \"0660353212\",\r\n      \"street\": \"rue\",\r\n      \"zip\": \"44100\",\r\n      \"city\": \"nantes\",\r\n      \"partner_id\": {{resPartner.id}},\r\n      \"groups_id\": [[6,0,[{{resGroups.Demandeur.id}},  {{resGroups.DemandeurExterne.id}}]]]\r\n    },\r\n    \"model\": \"res.users\",\r\n    \"session_id\": \"{{sessionId}}\",\r\n    \"context\": {\r\n      \"__ref\": \"compound_context\",\r\n      \"__contexts\": [\r\n        {\r\n          \"lang\": \"fr_FR\",\r\n          \"tz\": \"Europe/Paris\",\r\n          \"uid\": \"{{uid}}\"\r\n        },\r\n        {\"bin_size\": true}\r\n      ],\r\n      \"__eval_context\": null\r\n    }\r\n  }\r\n}"
        },
        "description": "resGroups.id = Demandeur externe\n28 : Demandeur\nresPartner.id = Particuliers Commune"
      },
      "response": []
    }
  ]
}